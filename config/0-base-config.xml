<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>#{RUNTIME_BASE_URL}</base-url>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.d0xZalpObGlEbWdGSmh1UQ==.fd4iZTbuyl9CW5Gk2BaX-A==.h-cVHlnV6deEvNs_x2-2LOncLFHSyHrD3ixbxIOnZCyUNc9t845ooQ4hKKVpehmi_o8vnLj6_-s97tSawLJfOxLPPg8oWSbDIagKJX3IVc8=.C1L2InUFkWCdAkX35cVh13swTEPzae6pwZO-VATVk2E=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>demo-web-client</id>
                <client-name>demo-web-client</client-name>
                <secret>$5$mUxe2gSXncUL5eLC$iS3hEmwGqFVl//ruK5Nvcd1L/shWW8SWkjmeIVujZ77</secret>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <scope>openid</scope>
                <user-authentication>
                </user-authentication>
                <allowed-origins>https://oauth.tools</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                  <introspection/>
                </capabilities>
                <use-pairwise-subject-identifiers>
                  <sector-identifier>default</sector-identifier>
                </use-pairwise-subject-identifiers>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.bVdPbFJ5N2xRT2RZRDZtYQ==.WGES-LrfaF5E99dDgDkd7g==.daU64PCxDyr_uvl3HUf0qkCYjZs0RrBTu60UELxB9JMIi9PiQLcJEtVmAty4E4Fl.rK1EToET7mQapgNaoDd5IvbkKgs70DanUIcYYPqYfYE=</connection-string>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.MWJORm9vUmRxcW5WWHVRcg==.ErSZXbAl6KFDIt9o5HapjQ==.3x9NpzYLuYSKQZYNMeU6jw==.O-cvSR9TRKcE9v7Do3vlD9M7tnLIHJAl9LEGMoMmJLQ=</password>
          <username>postgres</username>
        </jdbc>
      </data-source>
      <data-source>
        <id>devices_datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT count(1) as webauthn_device_count FROM devices JOIN accounts on accounts.account_id = devices.account_id where devices.device_type = 'webauthn' and accounts.username = :subject;</attribute-query>
          <connection-string>data:text/plain;aes,v:S.Tk1JQUE2d2ZvMWJGZ3RxNg==.NY8xjWxKh8kom_sLNOtfYg==.v0fvGU5eRyRWSBwJY-SV60Hnqc1v5Di8KyXdHTYAl6ch1-AqXn10MOoKlTA4TB0J.h27qdqQTbHiMF1kImBTgnltCBPd2h6on1nGNO_0SmYc=</connection-string>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.TG9mcGU5UUg1SkZ0cTJ0cQ==.GfLpnUgMJWGfAo_vbLNytQ==.sA_H5HIDhdHqSnBnIRMdMQ==.AS1bvQg8x89_YxrBL9VVIElFrIwJ4Cnbzl_Qe_5zyH8=</password>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.b3hDY0hkaHh5ZUZIWks0Ng==.ApObgZcQCYbZENhMBQsMVA==.Gjc8f3uV-IKDg7cNvR1h-3FL5VXDORAWZgB3bf4sMWYerjGW8-o7t2lwFI26l0Xor3PDrkKH2HjDIgPjExUaPdLf44GeCpyrbvlFB6_4die4msu3Qf5nO1lm8qq8JJkMiY3temBUyKyPhhOEUx7kq5-XNb2jo7MQJY58gvd_SHo0HlTjUd1OHZid1G0Gl9FwxazCxbfcf7uTSxYCtslwsJVa4J-fi_wD6qqKTGjUI7aKxXce4hXTY27Dvbv66YfasAOaUhHyYJgcSN5-rqqqP4B_rhdEYmS4aCcWgR0Rml3yKj21IYY3nKwIraNBVXtbGfrkDYkLLFDeoZXC8SCja283vO-D33iaXbjEPce7vTrJIopUauGsIo9D5_vHxfDJeoSKTAC7sU13DMFCAcIX-M1Mbyj888FHucUZ-iGfnRqAZXaO9pLL9qcB6mrQcO5QtbhdYlgUqmaAxjOnTkpXjWj8o14nMsWNnaVmxfkfqdhNaDXCzuoeVOe2Nqq4UYyUOsAk02T_gBFZ_BWP9j32j-zH2lBad37fzVypV3_YFkS8zzalNwfRSI2gegxuk7NBuiOx6Mrk999K1MKdJqyplEvfIvWI1ojHkNdILrw-qGqLz6xX9aTHQfUO0QkoutlDvDDP0qOAR3uY0wPGdCOCr9HfEnTgLLo9kPrSOxfWfPZ3n4iewribkNv36IWmKLDJv-ux9URYvW1KnPLnP1gpHf0Z2uiWeE67r9Gulw_kk8KjBTb1kKsm3kEj2YB-RM3ZgPjcrX4dVBh5UjBiHwk26A20KcbNrDD9KwOu666i_PdDTJnEul1Zi5jNsefHuKM8v2tnCjxvjymiRgVJhK_Ldge4CY2N04TrBuOjbUMr6sw2y5_VKlG1kDI_G0CipcIh-DHeMuzriajdbq7eHbIt_ip5-XGp5c9tWIFpEkJevt1ctpBaCKzbSFlncIFAZmm8_Cp97uThOUbhcE0a59fP7V5fAf29oIbmGcZ8L94A68pAmuO93BxvUU5lx43NfbxXhXvXXVLV5KEPfdeuIoTGHJqmS7AdOuvb5GJYB6rXxSrnWUibFHW_55j7xxNeYnAibejzMleI0xV-3HggctiqueLIx9D0op56z0XUJBBZWK8FisjCEWhC8s8U5eNvxxgikMpRyFQlWb4yVeHAvDyYxpu7phJSKmebY68WqseFaz82WRuYMhM-_Dido7qqeFboz1nojRcxT_ydlKdejL2fAZE6oxqWS9YzpoAPo6vWJta2PvbXCeM592gQ8LFblDWrwZspNjrQSYTXNifRz357C1-uIZokPU_vcb54vjd3UBs4PVrSj7BvCmIrrzSHwHVbckEwDM36_C9P1enJ7UVdp_6opB3pD45cNTKPFYCNmqBtnOExW37VMWrPpNgnYVfanH_wDwTaK8DI3QqaAWgsU4sIzw0zuXsvfvDZ0IItAKTFCEFvgNndF86BgEAoL7lWadjCKSq7ijQvcPLc1tjaTCxLwYaGKyZG0w056CzkH5oS-fqs-BgLQZYpKdWxMwIQQyT6bTwp-3Ok200pSEvMafxhNkHB8XV15KMQzmTCelSXTVK_vUMlX4OdosaoqOJ2YN_zu6rA2nU_9v_mKTtLFYRGiihdb_2Y21htQec0lnDXi5Rm3129X8oBGYG5o4Lkv9uh3r3Tq78mhkdNH4t8zpocNF8rSDCQTwTgLK5QuHLd5XlqTsZSOe2eOu_0JXomwva_IY9ZkWE4gxpDhoaPq-g7kloZR1FlamilkKiFCXePkEOe6qw5D1e7H6SYIvWEM7j-LE7L9lJ396LxVW59fPn0GLoLEjEMK-0S4NAFJ9fsEX69A_Q4lDLulnGMkfJoedQEtYb7w3AqPkiY05t3G5INlQNGIBM5yBPo5tuC1a8h_qCJpoRERCYmLwDprcCeN38TEMdQHf5zHP_ZPyAAOWJw9wTbvDUzE9YMry5LjUJQcHbv50Uc5aY49r6SHOMah1MRZfJE7Nxb4j6d4diZXkGQmen2YV4OKGXuE89z_AQA7UONCeN9ggpgUZUKYfVG4mimWJbe0STlLwQ4cQrXq4SER8BqhgMUKlMPRZY6cCPo5j2ydM2ECYV7axe3nYMfqavAZHMkfhtzuy2jCXrNQ8BCD5dUO26RfOKX1RBWGPM8WehfKdrNs9MJIlOBAUjmdQit8P8FkVSPk0lVaECCy0TkS3W9hQOThv0RZOGB5X9kEc3csxvBnsLIDbhpY4ikcJMZ4zEF7meH2mLsvEIoYJan46pIh4z8ujZI5tvNVc0h3PPj24ZqL9VTyQCpd0lpqg2wKT_eVKwyZmlz_t9jn_moOYf0k-eoNVZPQD0MbkQ6g2DFxhn-2aeDF1BPWoUWsEaWXWS_ZD3TCGyuP7xun9HJV0Vc6rmTlvgP08KEbDPKqEAzf1-UWeBqqNWe6VSJda1m_d3brPyu8s9fWPqLoHf9VBfDb7_XEkWVJTT9qVz-U924OA9O5sc_fu741XlH8hYEgRttxjBT_xFuJ0vY0IWatNTi9guTypqCgaAvIu7DincsSiQZMhKSrC6nxZcjWG_Gv_7PR_IwNfbWaEWlYesjhvhIWrQHdMcoXqnzP1lAAQUXnfaP1MUs75nCAaISfKRijJ0wTKaBUtllAdfDPw60fPiyDzta-BYpm14l1_CLqyNTJr4iDnjMOs-69I7c0EarAGrDo1Oo5UE8pjRx1_zsF5IeJ0SXfcMr5896N2cNlUkR4hTJt6D9qvj7AHos9Kc7qA7ej-00oBHGE9cnSNGou-Zvtiw_ssip0MIIYhVABDUq447mtngEtvfwPR9-VPaOSle7TkUu7gkRj71BpvfO2n0JB63bsF11KyzDxeIrze3M398JSJ_mZ2n8V_eMBZm0IOvLdqJBByYvhzuA210NfvbzZAd_PBGkyPdZ2UYnvDV7jvNuKwtCRlmxSMaR-WNQN7EwpVZjpulk74bAbAtxxtTe7qq1S_s-B7edAc3bckXX23v2hztj6-g-X33H_tqVnCIz1afmE_pl4w7r2WTRGYiy03mcxYorfFmbSu6hWaLvByfoeIiibnSAn_gkRKT2T6T7qLLajIg8hL7NhP6LCXOkYTF3--AmRpvPDtFEiWnlLUfWMjRgiCNQFGO2SHI720qopmN_3jQ77ACMp2ZlWCI7aMj_iAzav_tAA_JwnzOZkEqbX32L3JFf8iaPVkkERwgokfirDhwkSPkQ6BY_o21Ap474cfyacwqJMpFPMdS8Zmjxt980ae50RHCxFb4BqQmvpfAzJq51q0pwGRryVYMwfsgq5-iJjsd3SeXizxi2S2Z10tBn9ctne_Z92wHxnGdnF6OB98a_C1UlopJsKPkrU70rwiWamXA7Uwi2tbT9zFIe4DdAZ1gDD7fbY-d6Oae7uf0SL5G4sAofNCTwjluohUV0xFZdu0KSyPCWN1KFyeRuWMAarU8joa9oUHxc10Mz9YEnyrJPS7PCJ92fEPKlECEiR7MOzz7XExf2PeZ-sAN_p14aFdsFwsZWBUKHDgdSvINeI45HmvLfhhiAUQygPcy9p_lKHTHvMfMp2H1J726pHfpOuy1-3Q3BU1r8yqIVMnteseH9Z9UH56Zc05NE-bAUt1t2SUFSZ9qxCXZ9mTcOOLquVKqFcFbD.0NDrxLHJ9EJ1edpm5qobbWAOWrMZQInkOkcgjHWiDD0=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.VVNVNDgydzcxakNQN0l1Ug==.-cyB8JCEHrt3Hv2NCSJZtg==.9j-1K0_77XvJkRvMWUTbkvhy78BxaOtF_bs-680l4yWBeAtJIa6jT43jZ5pxntop7pHghpVzwRWUh09ADumWWN54QK6XV-OnoBNGHVT6KIrbH7lZw5Z72HvgmcVu6HKBNNyvW9PYtKMNYuj4EV5hQNLt8zoP0WpZDGXFXnrwQPL7AGWCMT1J0jOaLFRNMg4TQ73lPC-bh_YzemQl09FdED7AOYulrIXPgREJel9os-FACj4MNu4idVDlMoo7eUBQLt33FxEUTZ9X7bMBRFAoKeNyqktB9rKIMI4zuueVZ1eHasV_0twA93hMfe9pnz8Ny24sSnVIzpcKvvP8baFnJAb9UbEFu-1IefdVFKOL7qHPJM8fGojmot-wC5F-xeSNfGeqtLXp-NVolh0maXL4CeRrttaoDO11mrAo1ctO5NuCr6h0SmJR_quWsDmsRTg7Z2k-frJSCQM8RLgTAy0Na1PD0VB0Pf_Ggpa3Vtq0elP8vojCsLgIcuzk-Rvh8pAyZtGzBgmCdQ6TmfE7SUA92VeUa0S05C8MgFhQoqIYQLMhBtjzOnEdiH_AkdH1EoUqjiq-YdEQHaGMdDu2R-Ql566W3tTb-DxfcZZC8hn2Pv86hMkrWwzxHn0R1gtzMTGgxAC3WpA_VwHX7NBVYGQtTRBH0vLaQK2ohQ5X5VL_1Y6PzqUe-UvwElqjMcjXz1ESDK4Lqj1HOTyi02pG8B09miICUsYNFtSjjg7ppCxh7uQsJ83jr6FlTO2a58iawcyM4FayDpe5JpBRIaNEW7stRKsabQ0sVVRgo2LS1XL7obcXfa6_ITBlgn918AJo0PGxDSGJ2us6cZgY9uPtdX-NH4ct1MWHABbdC5bmoAuHzAgfyLnq5r5DrqeE05bjru8FmPSboL88H6fHkCEkXL8mlPZ2FYeMnLLi558zw8P4Xq8USRCBdO9D5HVKNso0bJNxXztz5GN1PokroAqg_pJ6U79gWkjd_cyaPIz-YiwBjDUltbG_3cEweXcrUCq1gIABSzWsbTrz0p3lTrNOXOKvPMaCpThUfJPSmaDqo5-8Zxe88JUYUSPo5LReSuVCTvh8ImvU8eeBlTqB8JGrMcsU1jYCAy52wMa_BlTXqjhp18IsqmnySNrLZwDKydKP1t4rfoyCGi4kwohgFp3W-K2IuW-gzhOvnNQqfo05QSVLH14ZlCwlAmWEqpPwYnobzWJB_90DNDycH24qCbzaeGNw_zWpmoDMZSrUXRIW7bTg6Y-k7uq_yInW7EsR09yVUq6bOEnbNdEhh_L6oGm037emRguGHEcnuL8pDudSBX_66xLpFTMAwCFsz4tHw9t8Sch375HdzrLw8Z2lyEKt8OqsH4mxtk5RtNOO8mqWs1EbCoNrg9H1TbKlEZB7d7P5bfQsS0gWrwhmIKDM8xk5G4KkUlRUdlicepXQihGgV0P7_ZkLRbSEugHMUITOERXbGcEGYeDNDoOq4yDsC87GW8y_FhKzQnMX_PXc7_vGxHrtJYh6MCrdsCv2VuZRvT833S4mZsTckri3YpRdqhXIItZ7UlL99-g9SAA9hlooi_p401VrZ9Fm45nPBJnQXJgJCHvVlG2KeYyLCX__rRQBF6A3yq-zwZ2wWrIv1rlMvAkud7TSP4QPGpjNqF0mF9uTeLA7JwxV6jMZ_5Obeh78Dx6uiercDVHeChGaYbP2_J-S_JCicYklvtzDvSUwuHOgHriY8jlzIXVlVMFkptjX6Q6assIEzEIdYGzmc5fLDiDpdeokPMULwQJCeknAWhkJDp9YKUihl4lzig01yrSZNVacO7qVgWBtekJ3Ke7CyPzCguh5aVDs_yOuuSJMoLKqtHT-1ywBTd692pi6H4uGEMabvgHaMOgJYqoU0izwpty_WdSZOugkN_jIsZI8vRWgpofgdPLK_aaqMRbHwvOhauyyUsE4ktdQH2cYs32H3JOe_9LsmbSAscePl14Y4F6swSFd6xTD9U6spg81wToCAlQzf6caJp4pK12gEPCtnvA0JNF73jItScObbKCxrpAFUlBS9sPYpwHk_KINlYmY8jg6NJYhXl1yWDCX1cHAWB_mvIq97gKZ27XjPYijqI2m_okeyx_7d_m9Ywhhqwdhmd9c9D9gIFNCJZwKW8GSgX4Zxnrteg6PxfgUEfiAs29nVMPUCbnCN559fV6u-n0cu7ZWr4jSSXnXwuuaQCBZdiO3YLbQQmp16Z796EYtMVau2QzDCpCk9TmW0trTxizKR4cYqlTLCrMdqq0dS_cGQGKERNLruQSqD9Dz-pVX5pH22vMNXbCNZHBYr1lBqR1BVW9UDx0YOTCDwAaxiWzvvDcVKZvQQmYFWbqW7H1yr5wPLjJBSdG-bXkiBTyyWZSKKCrXEZPoOoALzjgUvOY-gCqI97GAuBzy4zl6QKWxQwKhqR5qSg1ApN2xM5i5hDANfczlL8Fy8J9ZzNtNUydWsE582CfnpdBe7KCoejS-doql2RAy4kF7DEew1C7okaftE9rzjweGWr41BtwkWJUiNy3vO1EKhuz6XiE8aJflQC1SkvD5Fpzgt6XeKqnaam-yT-eqLqfWEeuGu4GyoLUGmbJEeJVBEQsIbzVK3jupI87ULIUeCGen_G72NUc7UMPr8ZVtXUPEsaTVY_UTfQ-U1P-NyQUnKlS2DtkkHNdUyajwxsnG4fpcGxLCdonbmc6iq5ocLjrqIOlPp7r7g5UOk1OlQRKLN1fRRkvA3QISjv5xXwcWcrjhsl48Bsk1jYPYLRmKMjLl6JpUrDPF36HY5xy-Gpp4sqBcOjancEtD3s185QjR0mabbu8iszdxgCprXBN9PU8QgwNc3lZnPfIBRyarUCRen2_cjeIwqHYOSh_dMbHh0l6k6AuyhLqK2ArNP6ZLT5edH6LNjyH2JC80Ui5PjDCWVWDe3Xp-RoMaW6hVY8n88Ug3-L02W8OCOWC1bCXLyWRPuqePTSKJ3OUin-dnbbQbYy2k6O0Y3FZkMczZIDXXJGua2m2vQ2uKIvav1KN-u6l1ZCUbCiipNlEavS4YvkTcC5SHmChFFZ1KH4Uwm9qNSF0RSJw41Be50JFTuVObGBIjhv9F9EkoCZrAuJsrHxeuC8or-1FpYcmC-dO4Hwkz3MBzZ3Fst5vMA1sdAMA4Q_LskeG-xUOkT_gNwBbYaZf7jrhVXhB5AlE7DJK0JBvtSqB-vMJKbYiRavPBVJ1YjqrOD-Oo1eEJWAabsxZ_LON7sbOGPyDqblxRF6HaaKi2Gtj22leDVe52hV8R4wefvKVv258ysw8i0MJqZFSYVGANb9Kf-H6eXm7NaelN8c-KFA6-6CMNPuRtJiiYXup8nV5kDPdF9CjV604TrDGfHZV6mFK-_BXblwLA9jmKCCXjCsRUzphrWJsJPieNgG7FBoVgqodx8EI54_9hgc4H2xBFhvSjrrKI6alnfLRICIxKGlmvx7sFqR8J2lx2nl-GljqRzW4vuJzn7sCQ1rr9nGmRtl5jIYtvtHybxqSsl_jlFVM1BWEd7kK5T0geIwq6BsjQRIFy9EniOYBWuZq8RgIHi6C5K5Q1Cp51Lpkokm31inNCplElvtM55fixiwrn2x_fxEj6F_KZP-BCFQsluC__Sc88OkmZT7sVnaERR-gj.z3uF1BDPB6k0FU0MAPTmz7NpfZ4UxqGLl-cdJH8B6s0=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.TVN4ME5IeUlNbFdWaG9nbQ==.hyWBBsx1zBEDXQPx2-cWPQ==.RSOolF1a1T17vc2mYcCs0bx7QCulEtM_4RzyQQpdGduk3pwXdPptBFpSgC-URY4XEF3CoAbErL3CFe_BzHM97GXkzrjL4yLzHoRmGMNV4es4mbTPbwRE-LsPIzivTEIFnqOnomASuF5QiJAjGnW-_otkoJ1mulTnJNutJbrH3MTB6acdBdXAZ4JlC-T1KR0_fT3cC2bz-VSm9NLLTwBPX_YpsSDZCh0QKKSBRLGBP9Fz16L1U-sIzs-tqwV9FffJL6hGjDIpXihfed0Wt4IoeOzTD-0H1qY0yel7aY0XRHHTVmVs4F5dS_AmA14xvuJGpLP1FDiEki28IXBAU5rQFPckBQviMqzdwUOw0VQTAwksc3XFNXKxlr9ZyOGsCxu8bj2Qehy7Efc_FY2YStSPXwxfFlbmyEMJVLPS7Wa0FJHDhmH0EVI7HgGqMy1_5iAqq6d-R7ReVAlAPI6cZDx7WmNQnMdd0jCiEu6aKf47h2MSTwMBlYYep1x14cDtsU3TwlHEwi_G8KVdPxMliH7d18_-fR7lz3gs3VcV8Q0_Z0eFB8_1ZaWtQmPe6_z7GU1idDnHQ8gj4b7qHAaXQOAuQVA-7xjQclXp9OKNNvC-zb_K9AATxHUh_BY5jl-fAOGJzrafbJrrPUXTGe3tb9stsFIl6HPdOovKsCkIGomjr7dEIqC6EwkxHMmbYyS6z-cLlWjQQRibdDICVHoNc5tBQU86c6E8WEfZq5mgHO9CkdJ3yX_PrX-hgB50b6pGY3rGBO69baxcMqzuvxPSF0AadF0Y6su5iyhibyIoHkOO_l4msFaEX4Qd-b2EpnqMVbBjYaukO08rFIPmyxC9BWuFwlRVjkC98LTSkY_gBT-bVZUboZ6jcHSPXtSHnK4s2A4xHxix6mI_6CFjUTdIY2U2jzmqALMUYulVQ3OhkXwxl7ojDB4aTiWVfrclCIPPfsaZnRwc4yrZWFKmf1msPSFHavedXa0IFc4p4fq287nbPoPOhIc3arDtfkTgFcSIkEKN5cNBijPDL14c4xKdZ8DFZzdv2kf6fBFrv732LSSoEO3Pc-Tp8KEpLql_gV0q_wONVcQLudoXnJF30SxTK7smFaqz1jy9jXW3_4RI_QpB8oOUu-5_xoE8Ve8FoiPqOPhof5n58REQSMIfQzgsEwohvcCMriHuEiwpfXwnIyEvuKSzefnZhda5gDM6Om-isFKcNAjpyZGH55wXkT4ftCRG-_m7CMo80ilhYPKMj76FfcsqTtpdFEqTKPKyHi_aYrLYlVeQgP1n__2S8t97Mom6d3yp-R8AD8Ipes3jlb473dMF87zbbzceQeqVnTGSRAiS12buDd9CR9_aUgWDk4YidSvMuTX5qg8nrzQi6hwXAbnmoxVO2IWUKnFH-lDVKGJPzejNnpU87gCkMG9pIU1u7esDigMPmc0hNFRxeRIItVSh4YSX5hyNbkHSl-p3mlAECHKS9mZqQhARwQF2FeEhlWIg2_ktHFb0iU9dA1e6DrM6rDCsW0Eo36qRS2JHgShKEu-pvRnXGTh7L8is6ncnRtrlhx_bMAQPp4SUTLS4LD2_L1FuIh1cuC_nLLsFmSvcqIGpgozii8RiOLcpH7PqaDCy1saiRguvjhAxsm32JwclRCgN0d8uYC2LbsDqSSfouBAZdC_e1U6Zring9appkw==.Yzwb-nXj7ezHTNSqZ7nCowk-hkMQd3qnnig1PUNHqFg=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <procedures>
      <transformation-procedure>
        <id>set-authmethod-flags-proc</id>
        <script>LyoqCiAqIFRoaXMgaXMgYW4gZXhhbXBsZSBwcm9jZWR1cmUgdGhhdCBwZXJmb3JtcyBubyB0cmFuc2Zvcm1hdGlvbgogKiBAcGFyYW0ge3NlLmN1cml0eS5pZGVudGl0eXNlcnZlci5wcm9jZWR1cmVzLmNvbnRleHQuVHJhbnNmb3JtYXRpb25Qcm9jZWR1cmVDb250ZXh0fSBjb250ZXh0CiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICB2YXIgYXR0cmlidXRlcyA9IGNvbnRleHQuYXR0cmlidXRlTWFwOwogIGlmIChhdHRyaWJ1dGVzLmF1dGhtZXRob2QgPT09ICd3ZWJhdXRobicpIHsKICAgICAgYXR0cmlidXRlcy53ZWJhdXRobiA9IHRydWU7CiAgICAgIGF0dHJpYnV0ZXMuaHRtbGZvcm0gPSBmYWxzZTsKICB9IGVsc2UgewogICAgICBhdHRyaWJ1dGVzLndlYmF1dGhuID0gZmFsc2U7CiAgICAgIGF0dHJpYnV0ZXMuaHRtbGZvcm0gPSB0cnVlOwogIH0KICByZXR1cm4gYXR0cmlidXRlczsKfQ==</script>
      </transformation-procedure>
      <transformation-procedure>
        <id>set-webauthn-flag-proc</id>
        <script>LyoqCiAqIFRoaXMgaXMgYW4gZXhhbXBsZSBwcm9jZWR1cmUgdGhhdCBwZXJmb3JtcyBubyB0cmFuc2Zvcm1hdGlvbgogKiBAcGFyYW0ge3NlLmN1cml0eS5pZGVudGl0eXNlcnZlci5wcm9jZWR1cmVzLmNvbnRleHQuVHJhbnNmb3JtYXRpb25Qcm9jZWR1cmVDb250ZXh0fSBjb250ZXh0CiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICB2YXIgYXR0cmlidXRlcyA9IGNvbnRleHQuYXR0cmlidXRlTWFwOwogIGF0dHJpYnV0ZXMud2ViYXV0aG4gPSBhdHRyaWJ1dGVzLndlYmF1dGhuX2RldmljZV9jb3VudCA+IDA7CiAgcmV0dXJuIGF0dHJpYnV0ZXM7Cn0=</script>
      </transformation-procedure>
      <transformation-procedure>
        <id>update-subject-before-save</id>
        <script>LyoqCiAqIFRoaXMgaXMgYW4gZXhhbXBsZSBwcm9jZWR1cmUgdGhhdCBwZXJmb3JtcyBubyB0cmFuc2Zvcm1hdGlvbgogKiBAcGFyYW0ge3NlLmN1cml0eS5pZGVudGl0eXNlcnZlci5wcm9jZWR1cmVzLmNvbnRleHQuVHJhbnNmb3JtYXRpb25Qcm9jZWR1cmVDb250ZXh0fSBjb250ZXh0CiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICB2YXIgYXR0cmlidXRlcyA9IGNvbnRleHQuYXR0cmlidXRlTWFwOwogIGF0dHJpYnV0ZXMuc3ViamVjdCA9IGF0dHJpYnV0ZXMub3JpZ2luYWxfc3ViamVjdDsKICByZXR1cm4gYXR0cmlidXRlczsKfQ==</script>
      </transformation-procedure>
      <transformation-procedure>
        <id>update-subject-proc</id>
        <script>LyoqCiAqIFRoaXMgaXMgYW4gZXhhbXBsZSBwcm9jZWR1cmUgdGhhdCBwZXJmb3JtcyBubyB0cmFuc2Zvcm1hdGlvbgogKiBAcGFyYW0ge3NlLmN1cml0eS5pZGVudGl0eXNlcnZlci5wcm9jZWR1cmVzLmNvbnRleHQuVHJhbnNmb3JtYXRpb25Qcm9jZWR1cmVDb250ZXh0fSBjb250ZXh0CiAqIEByZXR1cm5zIHsqfQogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICB2YXIgYXR0cmlidXRlcyA9IGNvbnRleHQuYXR0cmlidXRlTWFwOwoKICBhdHRyaWJ1dGVzLm9yaWdpbmFsX3N1YmplY3QgPSBhdHRyaWJ1dGVzLnN1YmplY3QKICBhdHRyaWJ1dGVzLnN1YmplY3QgPSAnZ2FyeS5hcmNoZXJAY3VyaXR5LmlvJzsKCiAgcmV0dXJuIGF0dHJpYnV0ZXM7Cn0=</script>
      </transformation-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <username-is-email>true</username-is-email>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$WhWGWQUy$I4nr/D37tD9yV2Kq8uR9y5VjKNUl2DNYSTEG69rUiyA</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>